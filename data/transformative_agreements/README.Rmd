```{r, echo = FALSE, warning = FALSE}

knitr::opts_knit$set(base.url = "/")
knitr::opts_chunk$set(
  comment = "#>",
  collapse = TRUE,
  warning = FALSE,
  message = FALSE,
  echo = FALSE,
  fig.width = 9,
  fig.height = 6
)
options(scipen = 999, digits = 2)
knitr::knit_hooks$set(inline = function(x) {
  prettyNum(x, big.mark = ",")
})
```

## Transformative Agreements data set

OpenAPC maintains a dedicated data set comprising articles published under transformative and other publishing agreements such as the Springer Compact pilot agreements or the German DEAL agreements. Before June 2019 this collection was known as the [offsetting data set](https://github.com/OpenAPC/openapc-de/tree/master/data/offsetting).

Unlike in the main APC data set, the Transformative Agreements (TA) data set focuses on publications that are part of publishing agreements. Many of these articles do not carry article-level cost information, as costs are often covered by aggregated contract payments (e.g. publish and/or read components) rather than individual publication fees.

At the same time, publishing agreements may also include publications for which article-based charges apply (e.g. discounted APCs within such agreements). These articles are also recorded in the TA data set and may include cost information at article level where applicable. 

Contract-related metadata and aggregated cost information are recorded separately in a dedicated contracts data set (contracts.csv). Articles in the TA data set are linked to their respective contracts, allowing analyses that combine publication output with agreement-level costs without assigning aggregated contract costs directly to individual articles.

The TA data set is relevant for analyses of publishing patterns under agreements and provides insights into the distribution of publications across publishersâ€™ portfolios, supporting discussions on differentiated pricing models and institutional publishing strategies.

Academic institutions and research funders globally are invited to contribute data on publications under publishing agreements to support a comprehensive data set that enables extensive analyses and fosters transparency in scholarly publishing.  

## Overview
```{r, echo = FALSE, warning = FALSE}
require(dplyr)
require(ezsummary)
my_apc <- readr::read_csv("transformative_agreements.csv")
my_contracts <- readr::read_csv("contracts.csv")
my_apc <- my_apc %>%
  left_join(my_contracts, join_by(group_id))
  
```
This dataset contains information on `r nrow(my_apc)` articles, published at `r length(unique(my_apc$institution.x))` institutions under `r length(unique(my_apc$contract_name))` different transformative agreements. The data can also be inspected as a [treemap visualisation](https://treemaps.openapc.net/apcdata/ta-euro/).

### Breakdown by agreement

```{r}
my_apc %>% select(contract_name, euro.x) %>% 
    group_by(contract_name) %>% 
    summarise(count = n()) %>% 
    arrange(desc(count)) %>%
    knitr::kable(col.names = c("Agreement", "Articles"), align = c("l","r"))
```

### Breakdown by institution

```{r}
my_apc %>% select(institution.x, euro.x) %>% 
    group_by(institution.x) %>% 
    summarise(count = n()) %>% 
    arrange(desc(count)) %>%
    knitr::kable(col.names = c("Institution", "Articles"), align = c("l","r"))
```

